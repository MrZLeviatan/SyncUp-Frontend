<div class="perfil-container">
  <!-- FILA DE PERFIL -->
  <div class="perfil-fila">
    <!-- TARJETA IZQUIERDA -->
    <div class="perfil-card info-card">
      <div class="perfil-foto">
        <i class="fa fa-user-circle"></i>
      </div>

      <div class="info-usuario">
        <p><strong>Nombre:</strong> {{ usuario?.nombre }}</p>
        <p><strong>Username:</strong> {{ usuario?.username }}</p>
      </div>

      <div class="acciones">
        <button class="btn-accion" (click)="mostrarEditarNombre = !mostrarEditarNombre">
          <i class="fa fa-edit"></i> Actualizar Perfil
        </button>

        <button class="btn-accion rojo" (click)="mostrarEditarPassword = !mostrarEditarPassword">
          <i class="fa fa-lock"></i> Actualizar Contraseña
        </button>
      </div>
    </div>

    <!-- TARJETA DERECHA -->
    <div class="perfil-card form-card">
      <!-- FORM ACTUALIZAR NOMBRE -->
      <div *ngIf="mostrarEditarNombre">
        <h3 class="subtitulo">Actualizar Nombre</h3>

        <div class="form-group">
          <label>Nuevo Nombre</label>
          <input type="text" [(ngModel)]="nombreActualizado" />
        </div>

        <button class="btn-guardar" (click)="actualizarNombre()">
          <i class="fa fa-save"></i> Guardar
        </button>

        <hr />
      </div>

      <!-- FORM ACTUALIZAR PASSWORD -->
      <div *ngIf="mostrarEditarPassword">
        <h3 class="subtitulo">Cambiar Contraseña</h3>

        <div class="form-group">
          <label>Contraseña Actual</label>
          <input type="password" [(ngModel)]="passwordAnterior" />
        </div>

        <div class="form-group">
          <label>Nueva Contraseña</label>
          <input type="password" [(ngModel)]="nuevoPassword" />
        </div>

        <button class="btn-guardar rojo" (click)="actualizarPassword()">
          <i class="fa fa-key"></i> Actualizar
        </button>
      </div>
    </div>
  </div>

  <!-- SECCIÓN CANCIONES FAVORITAS -->
  <div class="perfil-favoritas">
    <h3 class="subtitulo">Mis Canciones Favoritas</h3>

    <div class="favoritas-layout">
      <!-- Lista de canciones -->
      <app-lista-canciones
        [canciones]="cancionesFavoritas"
        [alturaLista]="300"
        (cancionSeleccionada)="onSeleccionarCancion($event)"
        class="lista-canciones"
      ></app-lista-canciones>

      <!-- Información de la canción seleccionada -->
      <div class="cancion-info" *ngIf="cancionSeleccionada">
        <h4>Información de la Canción</h4>
        <p><strong>Título:</strong> {{ cancionSeleccionada.titulo }}</p>
        <p><strong>Artista:</strong> {{ artistaSeleccionado?.nombreArtistico || 'Cargando...' }}</p>
        <p><strong>Duración:</strong> {{ cancionSeleccionada.duracion }} min</p>

        <div class="botones-cancion">
          <button class="btn-rojo" (click)="quitarCancionFavorita()">
            <i class="fa fa-trash"></i> Quitar de Favoritas
          </button>
          <button class="btn-azul-plateado" (click)="cancionSeleccionada = null">
            <i class="fa fa-times"></i> Cancelar
          </button>
        </div>
      </div>
    </div>

    <!-- Botón para descargar CSV debajo de la lista -->
    <div class="favoritas-botones-inferior">
      <button class="btn-azul-plateado" (click)="descargarCancionesCSV()">
        <i class="fa fa-download"></i> Descargar CSV
      </button>
    </div>
  </div>
</div>
